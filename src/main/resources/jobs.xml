<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:b="http://www.springframework.org/schema/batch" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/batch 
		http://www.springframework.org/schema/batch/spring-batch-2.2.xsd
		http://www.springframework.org/schema/beans 
		http://www.springframework.org/schema/beans/spring-beans-3.2.xsd">

	<import resource="context.xml"/>
		
	<b:job id="test">
		<b:step id="test1" next="test2">
			<b:tasklet>
				<bean parent="shellTasklet">
					<property name="command" value="pwd" />
				</bean>
			</b:tasklet>
		</b:step>
		<b:step id="test2" next="">
			<b:tasklet>
				<bean parent="shellTasklet">
					<property name="command" value="printenv" />
				</bean>
			</b:tasklet>
		</b:step>
	</b:job>
	
	<b:job id="setup">
		<b:step id="generate_input" next="create_tables">
			<b:tasklet>
				<bean parent="shellTasklet">
					<property name="command" value="sh" />
					<property name="script" value="${home}/script/setup/generate_input.sh" />
					<property name="arguments">
						<list>
							<value>${data}/input</value>
						</list>
					</property>
				</bean>
			</b:tasklet>
		</b:step>
		<b:step id="create_tables" next="">
			<b:tasklet>
				<bean parent="hiveTasklet">
					<property name="script" value="${home}/script/setup/create_tables.hql" />
					<property name="params">
						<map>
							<entry key="db" value="${hive.db}" />
							<entry key="input_ext" value="${data}/input" />
						</map>
					</property>
				</bean>
			</b:tasklet>
		</b:step>
	</b:job>

	<b:job id="job1">
		<b:step id="sum" next="">
			<b:tasklet>
				<bean parent="pigTasklet">
					<property name="script" value="${home}/script/job1/sum.pig" />
					<property name="params">
						<map>
							<entry key="udf" value="${home}/script/job1/udf.py" />
							<entry key="warehouse" value="${hive.warehouse}/${hive.db}.db" />
							<entry key="db" value="${hive.db}" />
						</map>
					</property>
				</bean>
			</b:tasklet>
		</b:step>
	</b:job>
		


</beans>